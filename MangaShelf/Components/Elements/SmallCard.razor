@inject IDialogService Dialog


@if (Volume != null)
{
    <MudCard @onclick="OpenVolumeAsync" Style="position:relative;" Class="manga-card ">
        <div class="image-container">
            <FallbackImage ImageUrl="@Volume.CoverImageUrlSmall" Class="@sideImageClass" Alt="@Volume.SeriesName" />
        </div>
        @if (Volume.IsPreorder && ShowBadges)
        {
            <div class="preorder-badge">
                <MudText Typo="Typo.caption" Align="Align.Center">@Localizer["Preorder"]</MudText>
            </div>
            <div class="preorder-date-badge">
                <MudText Typo="Typo.caption" Align="Align.Center">@Volume.ReleaseDate</MudText>
            </div>
        }
    </MudCard>
}
else
{
    <MudCard Style="position:relative;" Class="manga-card ">
        <div class="image-container">
            <MudSkeleton Animation="Animation.Wave" SkeletonType="SkeletonType.Rectangle"></MudSkeleton>
        </div>
    </MudCard>

}

<style>
    .my-custom-class {
        backdrop-filter: blur(10px);
    }
</style>

@code {
    [EditorRequired]
    [Parameter]
    public CardVolumeDto? Volume { get; set; }

    [Parameter]
    public bool ShowBadges { get; set; } = false;

    [Inject]
    NavigationManager NavigationManager { get; set; }

    [Inject]
    IUiLocalizationService Localizer { get; set; }

    private string sideImageClass = "card-image";

    protected override void OnParametersSet()
    {
        base.OnParametersSet();

        // if (Volume!.CoverNeedAdjustment)
        // {
        //     sideImageClass += " card-image-side";
        // }
    }

    private async Task OpenVolumeAsync()
    {
        // var parameters = new DialogParameters<VolumeDetailedModal>();
        // parameters.Add(x => x.VolumeId, Volume.Id);
        // var options = new DialogOptions()
        // {
        //     BackgroundClass = "my-custom-class",
        //     CloseOnEscapeKey = true
        // };

        // await Dialog.ShowAsync<VolumeDetailedModal>(string.Empty, parameters, options);
        if (Volume != null)
        {
            NavigationManager.NavigateTo($"volume/{Volume.PublicId}");
        }
    }
}